<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>DeFarm</title>
  <link rel="stylesheet" href="/frontend/style/dashboard.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
</head>
<body>
  <div class="main-wrapper">
    <!-- Sidebar -->
    <div class="sidebar">
      <div class="logo">
        <img src="/assets/images/Gambar.png" alt="logo">
        <span>DeFarm</span>
      </div>

      <h5>Navigation</h5>
      <ul>
        <li><a href="/frontend/component/dashboard.html" class="active"><i class="fas fa-home"></i>Dashboard</a></li>
        <li><a href="/frontend/pages/buah.html"><i class="fas fa-apple-alt"></i>Buah</a></li>
        <li><a href="/frontend/pages/pakan.html"><i class="fas fa-drumstick-bite"></i>Pakan</a></li>
        <li><a href="/frontend/pages/pupuk.html"><i class="fas fa-seedling"></i>Pupuk</a></li>
        <li><a href="/frontend/pages/sayuran.html"><i class="fas fa-carrot"></i>Sayuran</a></li>
      </ul>
      <h5>Other</h5>
      <ul>
        <li><a href="/frontend/pages/pengaturan.html"><i class="fas fa-layer-group"></i>Pengaturan</a></li>
        <li><a href="/frontend/pages/logout.html"><i class="fas fa-clone"></i>Keluar</a></li>
      </ul>
    </div>

    <!-- Main Content -->
    <div class="main-content">
      <!-- Topbar -->
      <div class="topbar">
        <div class="topbar-left">
          <div class="icon-wrapper">
            <img src="/assets/icon/hamburger-menu.svg" alt="Menu" class="icon" />
          </div>
          <div class="icon-wrapper">
            <img src="/assets/icon/search.svg" alt="Search" class="icon" />
          </div>
        </div>

        <div class="topbar-right">
          <div class="icon-wrapper">
            <img src="/assets/icon/settings.svg" alt="Settings" class="icon" />
          </div>
          <div class="icon-wrapper notification">
            <img src="/assets/icon/notification.svg" alt="Notifications" class="icon" />
          </div>
          <div class="icon-wrapper">
            <img src="/assets/icon/profile.svg" alt="Profile" class="icon" />
          </div>
        </div>
      </div>

      <!-- Dashboard Content -->
      <div class="chart-container">
        <h2 class="chart-title">Buah dan Sayuran - Januari 2025</h2>
        <div class="chart-wrapper">
          <canvas id="salesChart"></canvas>
        </div>
        
        <div class="legends">
          <div class="legend-item">
            <div class="legend-color fruit"></div>
            <span>Buah</span>
          </div>
          <div class="legend-item">
            <div class="legend-color vegetable"></div>
            <span>Sayuran</span>
          </div>
        </div>
      </div>

      <div class="summary-container">
        <div class="summary-card">
          <h3 class="summary-title">Total Penjualan Buah</h3>
          <div class="summary-value fruit-summary">Rp 12.450.000</div>
          <div class="summary-change">+15% dari bulan sebelumnya</div>
        </div>
        <div class="summary-card">
          <h3 class="summary-title">Total Penjualan Sayuran</h3>
          <div class="summary-value vegetable-summary">Rp 9.780.000</div>
          <div class="summary-change">+8% dari bulan sebelumnya</div>
        </div>
      </div>

      <!-- Tambahan Table Container -->
      <div class="data-table-container">
<div class="add-row-container">
    <!--Fungsi untuk menambahkan data baru secara manual -->
  <h4>Tambah Data Baru</h4>
  <form class="add-row-form" id="addRowForm">
    <div class="form-group">
      <label for="newType">Jenis</label>
      <select id="newType" class="type-select" required>
        <option value="">Pilih Jenis</option>
        <option value="Buah">Buah</option>
        <option value="Sayuran">Sayuran</option>
      </select>
    </div>
    
    <div class="form-group">
      <label for="newName">Nama</label>
      <select id="newName" class="name-select" required disabled>
        <option value="">Pilih Jenis dulu</option>
      </select>
    </div>
    
    <div class="form-group">
      <label for="newQuantity">Jumlah (kg)</label>
      <input type="number" id="newQuantity" min="1" required>
    </div>
    
    <div class="form-group">
      <label for="newPrice">Harga per kg (Rp)</label>
      <input type="number" id="newPrice" min="1000" required>
    </div>
    
    <button type="submit" class="add-btn">Tambah Data</button>
  </form>
</div>
        <h3 class="data-table-title">Daftar Buah dan Sayuran</h3>
        <table class="data-table">
          <thead>
            <tr>
              <th>Jenis</th>
              <th>Nama</th>
              <th>Jumlah Terjual (kg)</th>
              <th>Harga per kg (Rp)</th>
              <th>Aksi</th>
            </tr>
          </thead>
          <tbody>
            <!-- Data Buah -->
            <tr class="fruit-row">
              <td>Buah</td>
              <td>
                <span class="static-text">Pisang</span>
                <select class="editable-input">
                  <option value="Pisang">Pisang</option>
                  <option value="Mangga">Mangga</option>
                  <option value="Nanas">Nanas</option>
                  <option value="Durian">Durian</option>
                  <option value="Manggis">Manggis</option>
                  <option value="Buah Naga">Buah Naga</option>
                  <option value="Salak">Salak</option>
                  <option value="Belimbing">Belimbing</option>
                </select>
              </td>
              <td>
                <span class="static-text">120</span>
                <input type="number" class="editable-input" value="120">
              </td>
              <td>
                <span class="static-text">15000</span>
                <input type="number" class="editable-input" value="15000">
              </td>
              <td>
                <button class="edit-btn">Edit</button>
                <button class="save-btn">Simpan</button>
                <button class="cancel-btn">Batal</button>
                <button class="delete-btn">Delete</button>
              </td>
            </tr>
            <tr class="fruit-row">
              <td>Buah</td>
              <td>
                <span class="static-text">Mangga</span>
                <select class="editable-input">
                  <option value="Mangga">Mangga</option>
                  <option value="Pisang">Pisang</option>
                  <option value="Nanas">Nanas</option>
                  <option value="Durian">Durian</option>
                  <option value="Manggis">Manggis</option>
                  <option value="Buah Naga">Buah Naga</option>
                  <option value="Salak">Salak</option>
                  <option value="Belimbing">Belimbing</option>
                </select>
              </td>
              <td>
                <span class="static-text">85</span>
                <input type="number" class="editable-input" value="85">
              </td>
              <td>
                <span class="static-text">25000</span>
                <input type="number" class="editable-input" value="25000">
              </td>
              <td>
                <button class="edit-btn">Edit</button>
                <button class="save-btn">Simpan</button>
                <button class="cancel-btn">Batal</button>
                 <button class="cancel-btn">Delete</button>
              </td>
            </tr>
            
            <!-- Data Sayuran -->
            <tr class="vegetable-row">
              <td>Sayuran</td>
              <td>
                <span class="static-text">Kangkung</span>
                <select class="editable-input">
                  <option value="Kangkung">Kangkung</option>
                  <option value="Bayam">Bayam</option>
                  <option value="Sawi">Sawi</option>
                  <option value="Daun Singkong">Daun Singkong</option>
                  <option value="Kacang Panjang">Kacang Panjang</option>
                  <option value="Mentimun">Mentimun</option>
                  <option value="Selada">Selada</option>
                  <option value="Kale">Kale</option>
                </select>
              </td>
              <td>
                <span class="static-text">75</span>
                <input type="number" class="editable-input" value="75">
              </td>
              <td>
                <span class="static-text">12000</span>
                <input type="number" class="editable-input" value="12000">
              </td>
              <td>
                <button class="edit-btn">Edit</button>
                <button class="save-btn">Simpan</button>
                <button class="cancel-btn">Batal</button>
                 <button class="cancel-btn">Delete</button>
              </td>
            </tr>
            <tr class="vegetable-row">
              <td>Sayuran</td>
              <td>
                <span class="static-text">Bayam</span>
                <select class="editable-input">
                  <option value="Bayam">Bayam</option>
                  <option value="Kangkung">Kangkung</option>
                  <option value="Sawi">Sawi</option>
                  <option value="Daun Singkong">Daun Singkong</option>
                  <option value="Kacang Panjang">Kacang Panjang</option>
                  <option value="Mentimun">Mentimun</option>
                  <option value="Selada">Selada</option>
                  <option value="Kale">Kale</option>
                </select>
              </td>
              <td>
                <span class="static-text">60</span>
                <input type="number" class="editable-input" value="60">
              </td>
              <td>
                <span class="static-text">10000</span>
                <input type="number" class="editable-input" value="10000">
              </td>
              <td>
                <button class="edit-btn">Edit</button>
                <button class="save-btn">Simpan</button>
                <button class="cancel-btn">Batal</button>
                 <button class="cancel-btn">Delete</button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Script untuk grafik -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const ctx = document.getElementById('salesChart').getContext('2d');
      
      // Data contoh penjualan
      const dates = ['Jan 1', 'Jan 5', 'Jan 9', 'Jan 13', 'Jan 17', 'Jan 21'];
      const fruitSales = [1200000, 1850000, 1500000, 2100000, 1750000, 2050000];
      const vegetableSales = [950000, 1200000, 1100000, 1650000, 1450000, 1550000];
      
      const salesChart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: dates,
          datasets: [
            {
              label: 'Buah',
              data: fruitSales,
              backgroundColor: 'rgba(54, 162, 235, 0.8)',
              borderColor: 'rgba(54, 162, 235, 1)',
              borderWidth: 1,
              borderRadius: 4
            },
            {
              label: 'Sayuran',
              data: vegetableSales,
              backgroundColor: 'rgba(75, 192, 192, 0.8)',
              borderColor: 'rgba(75, 192, 192, 1)',
              borderWidth: 1,
              borderRadius: 4
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                callback: function(value) {
                  return 'Rp ' + value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, '.');
                }
              }
            }
          },
          plugins: {
            tooltip: {
              callbacks: {
                label: function(context) {
                  let label = context.dataset.label || '';
                  if (label) {
                    label += ': ';
                  }
                  label += 'Rp ' + context.raw.toString().replace(/\B(?=(\d{3})+(?!\d))/g, '.');
                  return label;
                }
              }
            }
          }
        }
      });

      // Fungsi untuk edit table
      document.querySelectorAll('.edit-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          const row = this.closest('tr');
          row.classList.add('editing');
        });
      });

      document.querySelectorAll('.cancel-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          const row = this.closest('tr');
          row.classList.remove('editing');
        });
      });

      document.querySelectorAll('.save-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          const row = this.closest('tr');
          const inputs = row.querySelectorAll('.editable-input');
          const staticTexts = row.querySelectorAll('.static-text');
          
          // Update static text with new values
          inputs.forEach((input, index) => {
            if (input.tagName === 'SELECT') {
              staticTexts[index].textContent = input.options[input.selectedIndex].text;
            } else {
              staticTexts[index].textContent = input.value;
            }
          });
          
          row.classList.remove('editing');
          
          // Di sini bisa ditambahkan AJAX untuk menyimpan data ke server
          alert('Data berhasil disimpan!');
        });
      });
    });
    // Fruit and vegetable options
const productOptions = {
  'Buah': ['Pisang', 'Mangga', 'Nanas', 'Durian', 'Manggis', 'Buah Naga', 'Salak', 'Belimbing'],
  'Sayuran': ['Kangkung', 'Bayam', 'Sawi', 'Daun Singkong', 'Kacang Panjang', 'Mentimun', 'Selada', 'Kale']
};

// Update name dropdown when type changes
document.getElementById('newType').addEventListener('change', function() {
  const nameSelect = document.getElementById('newName');
  const selectedType = this.value;
  
  nameSelect.innerHTML = '';
  nameSelect.disabled = !selectedType;
  
  if (selectedType) {
    productOptions[selectedType].forEach(item => {
      const option = document.createElement('option');
      option.value = item;
      option.textContent = item;
      nameSelect.appendChild(option);
    });
  } else {
    const option = document.createElement('option');
    option.value = '';
    option.textContent = 'Pilih Jenis dulu';
    nameSelect.appendChild(option);
  }
});

// Add new row to table
document.getElementById('addRowForm').addEventListener('submit', function(e) {
  e.preventDefault();
  
  const type = document.getElementById('newType').value;
  const name = document.getElementById('newName').value;
  const quantity = document.getElementById('newQuantity').value;  
  const price = document.getElementById('newPrice').value;
  
  if (!type || !name || !quantity || !price) {
    alert('Harap isi semua field!');
    return;
  }
  
  const tbody = document.querySelector('.data-table tbody');
  const newRow = document.createElement('tr');
  newRow.className = type === 'Buah' ? 'fruit-row' : 'vegetable-row';
  
  newRow.innerHTML = `
    <td>${type}</td>
    <td>
      <span class="static-text">${name}</span>
      <select class="editable-input">
        ${productOptions[type].map(item => 
          `<option value="${item}" ${item === name ? 'selected' : ''}>${item}</option>`
        ).join('')}
      </select>
    </td>
    <td>
      <span class="static-text">${quantity}</span>
      <input type="number" class="editable-input" value="${quantity}">
    </td>
    <td>
      <span class="static-text">${price}</span>
      <input type="number" class="editable-input" value="${price}">
    </td>
    <td class="action-buttons">
      <button class="edit-btn">Edit</button>
      <button class="save-btn">Simpan</button>
      <button class="cancel-btn">Batal</button>
    </td>
  `;
  
  tbody.appendChild(newRow);
  
  // Add event listeners to new buttons
  addRowEventListeners(newRow);
  
  // Reset form
  this.reset();
  document.getElementById('newName').disabled = true;
  document.getElementById('newName').innerHTML = '<option value="">Pilih Jenis dulu</option>';
  
  alert('Data berhasil ditambahkan!');
});

// Helper function to add event listeners to new rows
function addRowEventListeners(row) {
  // Edit button shows Save, Delete, Cancel and hides Edit
  row.querySelector('.edit-btn').addEventListener('click', function() {
    row.classList.add('editing');
  });
  
  // Cancel button hides Save, Delete, Cancel and shows Edit
  row.querySelector('.cancel-btn').addEventListener('click', function() {
    // Reset any changes made during editing
    const inputs = row.querySelectorAll('.editable-input');
    const staticTexts = row.querySelectorAll('.static-text');
    
    inputs.forEach((input, index) => {
      if (input.tagName === 'SELECT') {
        input.value = staticTexts[index].textContent;
      } else {
        input.value = staticTexts[index].textContent;
      }
    });
    
    row.classList.remove('editing');
  });
  
  // Save button commits changes
  row.querySelector('.save-btn').addEventListener('click', function() {
    const inputs = row.querySelectorAll('.editable-input');
    const staticTexts = row.querySelectorAll('.static-text');
    
    inputs.forEach((input, index) => {
      if (input.tagName === 'SELECT') {
        staticTexts[index].textContent = input.options[input.selectedIndex].text;
      } else {
        staticTexts[index].textContent = input.value;
      }
    });
    
    row.classList.remove('editing');
    alert('Data berhasil diperbarui!');
  });
  
  // Delete button removes the row
  row.querySelector('.delete-btn').addEventListener('click', function() {
    if (confirm('Apakah Anda yakin ingin menghapus data ini?')) {
      row.remove();
      alert('Data berhasil dihapus!');
    }
  });
}

// Initialize all existing rows
document.querySelectorAll('.data-table tbody tr').forEach(row => {
  addRowEventListeners(row);
});

// Update the form submission to add new rows
document.getElementById('addRowForm').addEventListener('submit', function(e) {
  e.preventDefault();
  
  const type = document.getElementById('newType').value;
  const name = document.getElementById('newName').value;
  const quantity = document.getElementById('newQuantity').value;
  const price = document.getElementById('newPrice').value;
  
  if (!type || !name || !quantity || !price) {
    alert('Harap isi semua field!');
    return;
  }
  
  const tbody = document.querySelector('.data-table tbody');
  const newRow = document.createElement('tr');
  newRow.className = type === 'Buah' ? 'fruit-row' : 'vegetable-row';
  
  newRow.innerHTML = `
    <td>${type}</td>
    <td>
      <span class="static-text">${name}</span>
      <select class="editable-input">
        ${productOptions[type].map(item => 
          `<option value="${item}" ${item === name ? 'selected' : ''}>${item}</option>`
        ).join('')}
      </select>
    </td>
    <td>
      <span class="static-text">${quantity}</span>
      <input type="number" class="editable-input" value="${quantity}">
    </td>
    <td>
      <span class="static-text">${price}</span>
      <input type="number" class="editable-input" value="${price}">
    </td>
    <td class="action-buttons">
      <button class="edit-btn">Edit</button>
      <button class="save-btn">Simpan</button>
      <button class="delete-btn">Hapus</button>
      <button class="cancel-btn">Batal</button>
    </td>
  `;
  
  tbody.appendChild(newRow);
  addRowEventListeners(newRow);
  
  // Reset form
  this.reset();
  document.getElementById('newName').disabled = true;
  document.getElementById('newName').innerHTML = '<option value="">Pilih Jenis dulu</option>';
  
  alert('Data berhasil ditambahkan!');
});
</script>
</body>
</html>